#!/usr/bin/env bash

SWARM_PATH="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
SWARM_PATH="$SWARM_PATH/..";

docker stop $(docker ps -a -q --filter="name=swarm_snet")
docker rm $(docker ps -a -q --filter="name=swarm_snet")

docker run \
  --name swarm_snet \
  --detach \
  --hostname snet \
  --restart always \
  --cap-add=NET_ADMIN \
  --device=/dev/net/tun \
  --network=swarm -v ${SWARM_PATH}/config/openvpn/enabled_swarm:/etc/snet \
  {{SWARM_PORTS}} \
newtoncodes/swarm-snet:1.0.0

